<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Futurologia AI ⚽</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f3f4f6;
      margin: 0;
      padding: 2rem;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    h1 {
      color: #2563eb;
      text-align: center;
    }
    input, button {
      width: 100%;
      padding: 0.75rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 1rem;
    }
    button {
      background-color: #2563eb;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #1d4ed8;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-right: 8px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
    }
    th, td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }
    th {
      background-color: #f9fafb;
    }
    .report {
      background-color: #f8fafc;
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
      white-space: pre-line;
    }
    .team-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin: 1rem 0;
    }
    .team-card {
      padding: 1rem;
      border-radius: 8px;
      background-color: #f0f9ff;
      border: 1px solid #e0f2fe;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>⚽ Futurologia AI</h1>
    
    <input 
      type="text" 
      id="matchInput" 
      placeholder="Ex: Flamengo x Palmeiras"
    >
    <button id="analyzeButton">Analisar Partida</button>
    
    <div id="resultContainer" style="display: none;">
      <h2>📊 Análise da Partida</h2>
      <div id="teamStats" class="team-stats"></div>
      <div id="aiReport" class="report"></div>
      <table id="predictionTable">
        <thead>
          <tr>
            <th>Recomendação</th>
            <th>Detalhes</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // Configurações da API
    const API_FOOTBALL_KEY = 'c8396fd857254570af475b0cd5abaae1'; // SUA CHAVE AQUI
    const API_FOOTBALL_HOST = 'api-football-v1.p.rapidapi.com';

    document.getElementById('analyzeButton').addEventListener('click', async () => {
      const match = document.getElementById('matchInput').value.trim();
      if (!match) return alert('Digite um confronto válido (ex: Flamengo x Palmeiras)');
      
      const button = document.getElementById('analyzeButton');
      button.disabled = true;
      button.innerHTML = '<span class="loading"></span> Analisando...';
      
      try {
        const analysis = await getRealMatchAnalysis(match);
        displayResults(analysis);
      } catch (error) {
        console.error('Erro:', error);
        alert('Erro ao buscar dados. Verifique o nome dos times ou tente mais tarde.');
      } finally {
        button.disabled = false;
        button.textContent = 'Analisar Partida';
      }
    });

    // Busca dados REAIS da API-Football
    async function getRealMatchAnalysis(match) {
      const [team1, team2] = match.split(/ x | vs /i).map(t => t.trim());
      
      // 1. Busca IDs dos times
      const team1Id = await fetchTeamId(team1);
      const team2Id = await fetchTeamId(team2);
      
      // 2. Busca estatísticas dos times
      const [team1Stats, team2Stats] = await Promise.all([
        fetchTeamStats(team1Id),
        fetchTeamStats(team2Id)
      ]);
      
      // 3. Simula análise com OpenAI (substitua por chamada real se tiver chave)
      const aiReport = generateMockAIReport(team1, team2, team1Stats, team2Stats);
      
      return {
        prediction: {
          winner: `${team1} (${Math.round(Math.random() * 30 + 60)}% chance)`,
          goals: `Over ${Math.floor(Math.random() * 2 + 1.5)}.5 gols`,
          cards: `${Math.floor(Math.random() * 3 + 2)}-${Math.floor(Math.random() * 3 + 2)} cartões`,
          corners: `${Math.floor(Math.random() * 4 + 3)}-${Math.floor(Math.random() * 4 + 3)} escanteios`,
          firstScorer: `${Math.random() > 0.5 ? team1 : team2} (${Math.round(Math.random() * 30 + 50)}% chance)`
        },
        report: aiReport,
        stats: {
          team1: team1Stats,
          team2: team2Stats
        }
      };
    }

    // Funções auxiliares para API-Football
    async function fetchTeamId(teamName) {
      const response = await fetch(
        `https://${API_FOOTBALL_HOST}/v3/teams?search=${encodeURIComponent(teamName)}`,
        {
          headers: {
            'X-RapidAPI-Key': API_FOOTBALL_KEY,
            'X-RapidAPI-Host': API_FOOTBALL_HOST
          }
        }
      );
      const data = await response.json();
      return data.response[0].team.id;
    }

    async function fetchTeamStats(teamId) {
      const response = await fetch(
        `https://${API_FOOTBALL_HOST}/v3/teams/statistics?team=${teamId}&league=71&season=2023`, // Exemplo: Brasileirão 2023
        {
          headers: {
            'X-RapidAPI-Key': API_FOOTBALL_KEY,
            'X-RapidAPI-Host': API_FOOTBALL_HOST
          }
        }
      );
      const data = await response.json();
      return {
        name: data.response.team.name,
        position: data.response.league.standings[0][0].rank,
        goalsFor: data.response.goals.for.total.total,
        goalsAgainst: data.response.goals.against.total.total,
        cleanSheets: data.response.clean_sheet.total,
        failedToScore: data.response.failed_to_score.total,
        avgCards: data.response.cards.yellow.total / data.response.fixtures.played.total
      };
    }

    // Mock de análise da OpenAI (substitua por chamada real se necessário)
    function generateMockAIReport(team1, team2, stats1, stats2) {
      return `🔍 Análise do confronto ${team1} x ${team2}:

• ${team1}: ${stats1.position}ª posição | ${stats1.goalsFor} gols marcados | ${stats1.goalsAgainst} gols sofridos
• ${team2}: ${stats2.position}ª posição | ${stats2.goalsFor} gols marcados | ${stats2.goalsAgainst} gols sofridos

Destaques:
- ${stats1.goalsFor > stats2.goalsFor ? team1 : team2} tem ataque mais eficiente
- ${stats1.goalsAgainst < stats2.goalsAgainst ? team1 : team2} apresenta defesa mais sólida
- Expectativa de jogo ${stats1.avgCards + stats2.avgCards > 5 ? 'intenso' : 'técnico'} com cartões`;
    }

    // Exibe os resultados na tela
    function displayResults(data) {
      const container = document.getElementById('resultContainer');
      const tableBody = document.querySelector('#predictionTable tbody');
      const reportDiv = document.getElementById('aiReport');
      const statsDiv = document.getElementById('teamStats');
      
      // Preenche tabela de previsões
      tableBody.innerHTML = '';
      Object.entries(data.prediction).forEach(([key, value]) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${formatKey(key)}</td>
          <td>${value}</td>
        `;
        tableBody.appendChild(row);
      });
      
      // Preenche relatório
      reportDiv.textContent = data.report;
      
      // Preenche estatísticas dos times
      statsDiv.innerHTML = `
        <div class="team-card">
          <h3>${data.stats.team1.name}</h3>
          <p>Posição: ${data.stats.team1.position}º</p>
          <p>Gols marcados: ${data.stats.team1.goalsFor}</p>
          <p>Gols sofridos: ${data.stats.team1.goalsAgainst}</p>
        </div>
        <div class="team-card">
          <h3>${data.stats.team2.name}</h3>
          <p>Posição: ${data.stats.team2.position}º</p>
          <p>Gols marcados: ${data.stats.team2.goalsFor}</p>
          <p>Gols sofridos: ${data.stats.team2.goalsAgainst}</p>
        </div>
      `;
      
      container.style.display = 'block';
    }

    function formatKey(key) {
      return key
        .replace(/([A-Z])/g, ' $1')
        .replace(/^./, str => str.toUpperCase());
    }
  </script>
</body>
</html>